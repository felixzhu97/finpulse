@startuml c4-containers
!define RELATIVE_INCLUDE 1
!include ../../c4-lib/C4-PlantUML/C4_Container.puml

title FinPulse Fintech Platform - Container (Module) Diagram

Person(investor, "Investor", "Portfolio and market analysis")

System_Boundary(finpulse, "FinPulse") {
    Boundary(frontend_boundary, "Frontend Applications") {
        Container(web_app, "Web App", "Angular 21", "Financial analytics console: portfolio, market trends, risk, transactions")
        Container(mobile_portfolio, "Mobile Portfolio", "Expo + React Native", "Portfolio app: stocks, real-time quotes, native charts. Clean Architecture: Presentation → Application → Domain ← Infrastructure")
    }
    
    Boundary(backend_boundary, "Backend Services") {
        Container(portfolio_api, "Portfolio Analytics API", "FastAPI", "Clean Architecture: composition.py, container, crud_helpers. REST, WebSocket; AI/ML (payments, trades, customers, risk-metrics); blockchain; portfolio, market data; batch VaR, ClickHouse, MLflow")
    }
    
    Boundary(data_boundary, "Data Storage") {
        ContainerDb(timescale, "TimescaleDB", "PostgreSQL + TimescaleDB", "Portfolio metadata and history hypertable")
        ContainerDb(redis, "Redis", "In-memory", "History, portfolio aggregate, blockchain read cache")
        ContainerDb(clickhouse, "ClickHouse", "OLAP", "portfolio_risk_daily, delta_table_stats; read by API")
        Container(minio, "MinIO", "S3-compatible", "Data lake; Faust writes quote batches; Spark/Delta")
    }
    
    Boundary(messaging_boundary, "Message Queue") {
        ContainerQueue(kafka, "Kafka", "Event streaming", "portfolio.events, market.quotes.enriched")
    }
}

Container_Ext(market_api, "Market Data API", "External", "Third-party market data")
Container_Ext(vercel, "Vercel", "Hosting", "Web deployment and analytics")

Rel(investor, web_app, "Uses", "HTTPS")
Rel(investor, mobile_portfolio, "Uses", "HTTPS / WebSocket")
Rel(web_app, portfolio_api, "API calls", "REST / WebSocket")
Rel(mobile_portfolio, portfolio_api, "API calls", "REST / WebSocket")
Rel(portfolio_api, timescale, "Reads and writes", "SQL / asyncpg")
Rel(portfolio_api, redis, "Cache", "Redis protocol")
Rel(portfolio_api, kafka, "Publishes and consumes", "Kafka")
Rel(portfolio_api, clickhouse, "Reads analytics", "HTTP")
Rel(portfolio_api, minio, "Batch jobs write", "S3")
Rel(portfolio_api, market_api, "Fetches quotes", "REST")
Rel(web_app, vercel, "Hosted on", "Vercel")

LAYOUT_TOP_DOWN()

@enduml
