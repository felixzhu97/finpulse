@startuml

skinparam component {
  BorderColor #333333
  ArrowColor #333333
}

package "Channels" {
  component "Web App" as WebApp
  component "Mobile App" as MobileApp
  component "API Clients" as ApiClients
}

package "Edge Services" {
  component "API Gateway" as ApiGateway
  component "Auth Service" as AuthService
  component "Session Service" as SessionService
  component "Rate Limiter" as RateLimiter
}

package "Core Finance Services" {
  component "Account Service" as AccountService
  component "Customer Service" as CustomerService
  component "Portfolio Service" as PortfolioService
  component "Order Service" as OrderService
  component "Trade Service" as TradeService
  component "Payment Service" as PaymentService
  component "Settlement Service" as SettlementService
  component "Risk Service" as RiskService
  component "Pricing Service" as PricingService
  component "Compliance Service" as ComplianceService
}

package "Data and Analytics" {
  component "Positions Store" as PositionsStore
  component "Transactions Store" as TransactionsStore
  component "Reference Data Store" as ReferenceDataStore
  component "Market Data Store" as MarketDataStore
  component "Risk Metrics Store" as RiskMetricsStore
  component "Reporting Warehouse" as ReportingWarehouse
  component "Analytics Engine" as AnalyticsEngine
}

package "External Systems" {
  component "Banking Core" as BankingCore
  component "Exchange Connectivity" as ExchangeConnectivity
  component "Custody Service" as CustodyService
  component "Payment Networks" as PaymentNetworks
  component "Market Data Feeds" as MarketDataFeeds
  component "KYC Providers" as KycProviders
  component "AML Screening" as AmlScreening
}

WebApp --> ApiGateway
MobileApp --> ApiGateway
ApiClients --> ApiGateway

ApiGateway --> RateLimiter
ApiGateway --> AuthService
AuthService --> SessionService

ApiGateway --> AccountService
ApiGateway --> PortfolioService
ApiGateway --> OrderService
ApiGateway --> PaymentService

CustomerService --> AccountService
PortfolioService --> PositionsStore
PortfolioService --> MarketDataStore

OrderService --> TradeService
OrderService --> RiskService
OrderService --> PricingService
TradeService --> PositionsStore
TradeService --> TransactionsStore

PaymentService --> SettlementService
PaymentService --> PaymentNetworks
SettlementService --> BankingCore
SettlementService --> CustodyService

RiskService --> RiskMetricsStore
RiskService --> AnalyticsEngine
ComplianceService --> AmlScreening
ComplianceService --> KycProviders

AnalyticsEngine --> ReportingWarehouse
ReportingWarehouse --> PositionsStore
ReportingWarehouse --> TransactionsStore
ReportingWarehouse --> MarketDataStore

MarketDataFeeds --> MarketDataStore
ExchangeConnectivity --> TradeService
ExchangeConnectivity --> OrderService

AccountService --> ReferenceDataStore
CustomerService --> ReferenceDataStore

@enduml

